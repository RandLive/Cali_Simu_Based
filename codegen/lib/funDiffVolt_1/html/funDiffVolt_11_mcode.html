<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">F_out</span>=funDiffVolt_1(<span class="var type1" id="S3T2U6">x</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Calculate difference between measured and real voltage at each position</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="keyword">global</span> <span class="var type0" id="S4T0U8">varStartingPoint</span> <span class="var type0" id="S5T0U9">varNum</span> <span class="var type0" id="S6T0U10">meaVoltage</span> <span class="var type0" id="S7T0U11">refPose</span> <span class="var type0" id="S8T0U12">C</span> <span class="var type0" id="S9T0U13">K</span> <span class="var type0" id="S10T0U14">r</span> <span class="var type0" id="S11T0U15">m</span> <span class="var type0" id="S12T0U16">Koordinate_real_GLS</span> <span class="var type0" id="S13T0U17">m1</span> <span class="var type0" id="S14T0U18">minVoltage</span> <span class="var type0" id="S15T0U19">F</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T3:U3"><span class="var type1" id="S16T3U22">Koordinate_real</span> = <span class="var type1" id="S7T3U23">refPose</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T4:U6"><span class="var type1" id="S17T4U26">U</span> = <span class="var type1" id="S6T4U27">meaVoltage</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S18T1U30">j</span>=<span class="mxinfo " id="T1:U10">1</span>:8</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo " id="T5:U11"><span class="mxinfo " id="T5:U12"><span class="var type1" id="S13T6U37">m1</span>(<span class="var type1" id="S18T1U38">j</span>,<span class="mxinfo " id="T7:U15">:</span>)</span>=<span class="mxinfo " id="T5:U16"><span class="mxinfo " id="T1:U17">(<span class="mxinfo " id="T1:U18"><span class="mxinfo " id="T1:U19"><span class="var type1" id="S11T6U45">m</span>(<span class="var type1" id="S18T1U46">j</span>,<span class="mxinfo " id="T8:U22">1</span>)</span>+<span class="mxinfo " id="T1:U23"><span class="mxinfo " id="T1:U24"><span class="var type1" id="S3T2U50">x</span>(<span class="var type1" id="S18T1U51">j</span>,<span class="mxinfo " id="T8:U27">1</span>)</span>/<span class="mxinfo " id="T1:U28">100</span></span></span>)*<span class="var type1" id="S9T1U54">K</span></span>*<span class="mxinfo " id="T5:U30">[<span class="mxinfo " id="T1:U31"><span class="mxinfo " id="T1:U32">sind(<span class="mxinfo " id="T1:U33"><span class="mxinfo " id="T1:U34"><span class="mxinfo " id="T1:U35"><span class="var type1" id="S3T2U63">x</span>(<span class="var type1" id="S18T1U64">j</span>,<span class="mxinfo " id="T8:U38">3</span>)</span>/<span class="mxinfo " id="T1:U39">5</span></span>+<span class="mxinfo " id="T1:U40"><span class="var type1" id="S11T6U68">m</span>(<span class="var type1" id="S18T1U69">j</span>,<span class="mxinfo " id="T1:U43">3</span>)</span></span>)</span>*<span class="mxinfo " id="T1:U44">cosd(<span class="mxinfo " id="T1:U45"><span class="mxinfo " id="T1:U46"><span class="mxinfo " id="T1:U47"><span class="var type1" id="S3T2U76">x</span>(<span class="var type1" id="S18T1U77">j</span>,<span class="mxinfo " id="T8:U50">2</span>)</span>/<span class="mxinfo " id="T1:U51">5</span></span>+<span class="mxinfo " id="T1:U52"><span class="var type1" id="S11T6U81">m</span>(<span class="var type1" id="S18T1U82">j</span>,<span class="mxinfo " id="T1:U55">2</span>)</span></span>)</span></span> <span class="mxinfo " id="T1:U56"><span class="mxinfo " id="T1:U57">sind(<span class="mxinfo " id="T1:U58"><span class="mxinfo " id="T1:U59"><span class="mxinfo " id="T1:U60"><span class="var type1" id="S3T2U90">x</span>(<span class="var type1" id="S18T1U91">j</span>,<span class="mxinfo " id="T8:U63">3</span>)</span>/<span class="mxinfo " id="T1:U64">5</span></span>+<span class="mxinfo " id="T1:U65"><span class="var type1" id="S11T6U95">m</span>(<span class="var type1" id="S18T1U96">j</span>,<span class="mxinfo " id="T1:U68">3</span>)</span></span>)</span>*<span class="mxinfo " id="T1:U69">sind(<span class="mxinfo " id="T1:U70"><span class="mxinfo " id="T1:U71"><span class="mxinfo " id="T1:U72"><span class="var type1" id="S3T2U103">x</span>(<span class="var type1" id="S18T1U104">j</span>,<span class="mxinfo " id="T8:U75">2</span>)</span>/<span class="mxinfo " id="T1:U76">5</span></span>+<span class="mxinfo " id="T1:U77"><span class="var type1" id="S11T6U108">m</span>(<span class="var type1" id="S18T1U109">j</span>,<span class="mxinfo " id="T1:U80">2</span>)</span></span>)</span></span>        <span class="mxinfo " id="T1:U81">cosd(<span class="mxinfo " id="T1:U82"><span class="mxinfo " id="T1:U83"><span class="mxinfo " id="T1:U84"><span class="var type1" id="S3T2U116">x</span>(<span class="var type1" id="S18T1U117">j</span>,<span class="mxinfo " id="T8:U87">3</span>)</span>/<span class="mxinfo " id="T1:U88">5</span></span>+<span class="mxinfo " id="T1:U89"><span class="var type1" id="S11T6U121">m</span>(<span class="var type1" id="S18T1U122">j</span>,<span class="mxinfo " id="T1:U92">3</span>)</span></span>)</span>]</span></span></span>; <span class="comment">%#ok&lt;*AGROW&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T9:U93"><span class="mxinfo " id="T9:U94"><span class="var type1" id="S12T3U127">Koordinate_real_GLS</span>(<span class="mxinfo " id="T10:U96">:</span>,<span class="mxinfo " id="T1:U97">4</span>)</span>=<span class="mxinfo " id="T9:U98"><span class="var type1" id="S16T3U131">Koordinate_real</span>(<span class="mxinfo " id="T10:U100">:</span>,<span class="mxinfo " id="T1:U101">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T9:U102"><span class="mxinfo " id="T9:U103"><span class="var type1" id="S12T3U137">Koordinate_real_GLS</span>(<span class="mxinfo " id="T10:U105">:</span>,<span class="mxinfo " id="T1:U106">5</span>)</span>=<span class="mxinfo " id="T9:U107"><span class="var type1" id="S16T3U141">Koordinate_real</span>(<span class="mxinfo " id="T10:U109">:</span>,<span class="mxinfo " id="T1:U110">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T9:U111"><span class="mxinfo " id="T9:U112"><span class="var type1" id="S12T3U147">Koordinate_real_GLS</span>(<span class="mxinfo " id="T10:U114">:</span>,<span class="mxinfo " id="T1:U115">1</span>)</span>=<span class="mxinfo " id="T9:U116"><span class="var type1" id="S16T3U151">Koordinate_real</span>(<span class="mxinfo " id="T10:U118">:</span>,<span class="mxinfo " id="T1:U119">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T9:U120"><span class="mxinfo " id="T9:U121"><span class="var type1" id="S12T3U157">Koordinate_real_GLS</span>(<span class="mxinfo " id="T10:U123">:</span>,<span class="mxinfo " id="T1:U124">2</span>)</span>=<span class="mxinfo " id="T9:U125"><span class="var type1" id="S16T3U161">Koordinate_real</span>(<span class="mxinfo " id="T10:U127">:</span>,<span class="mxinfo " id="T1:U128">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T9:U129"><span class="mxinfo " id="T9:U130"><span class="var type1" id="S12T3U167">Koordinate_real_GLS</span>(<span class="mxinfo " id="T10:U132">:</span>,<span class="mxinfo " id="T1:U133">3</span>)</span>=<span class="mxinfo " id="T9:U134"><span class="var type1" id="S16T3U171">Koordinate_real</span>(<span class="mxinfo " id="T10:U136">:</span>,<span class="mxinfo " id="T1:U137">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T1:U138"><span class="var type1" id="S14T1U176">minVoltage</span>=<span class="mxinfo " id="T1:U140">0.002</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T1:U141"><span class="var type1" id="S18T1U180">j</span>=<span class="mxinfo " id="T1:U143">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="comment">% F=zeros(varNum);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S21T1U184">k</span>=<span class="var type1" id="S4T1U186">varStartingPoint</span>:<span class="mxinfo " id="T1:U146"><span class="var type1" id="S4T1U188">varStartingPoint</span>+<span class="var type1" id="S5T1U189">varNum</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo " id="T5:U149"><span class="var type1" id="S22T5U192">n</span>=<span class="mxinfo " id="T5:U151">[<span class="mxinfo " id="T1:U152"><span class="mxinfo " id="T1:U153">sind(<span class="mxinfo " id="T1:U154"><span class="var type1" id="S12T3U199">Koordinate_real_GLS</span>(<span class="var type1" id="S21T1U200">k</span>,<span class="mxinfo " id="T8:U157">5</span>)</span>)</span>*<span class="mxinfo " id="T1:U158">cosd(<span class="mxinfo " id="T1:U159"><span class="var type1" id="S12T3U205">Koordinate_real_GLS</span>(<span class="var type1" id="S21T1U206">k</span>,<span class="mxinfo " id="T8:U162">4</span>)</span>)</span></span> <span class="mxinfo " id="T1:U163"><span class="mxinfo " id="T1:U164">sind(<span class="mxinfo " id="T1:U165"><span class="var type1" id="S12T3U212">Koordinate_real_GLS</span>(<span class="var type1" id="S21T1U213">k</span>,<span class="mxinfo " id="T8:U168">5</span>)</span>)</span>*<span class="mxinfo " id="T1:U169">sind(<span class="mxinfo " id="T1:U170"><span class="var type1" id="S12T3U218">Koordinate_real_GLS</span>(<span class="var type1" id="S21T1U219">k</span>,<span class="mxinfo " id="T8:U173">4</span>)</span>)</span></span> <span class="mxinfo " id="T1:U174">cosd(<span class="mxinfo " id="T1:U175"><span class="var type1" id="S12T3U224">Koordinate_real_GLS</span>(<span class="var type1" id="S21T1U225">k</span>,<span class="mxinfo " id="T8:U178">5</span>)</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S23T1U229">i1</span>=<span class="mxinfo " id="T1:U180">1</span>:8        </span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T11:U181">(<span class="mxinfo " id="T1:U182">abs(<span class="mxinfo " id="T1:U183"><span class="var type1" id="S17T4U240">U</span>(<span class="var type1" id="S21T1U241">k</span>,<span class="var type1" id="S23T1U242">i1</span>)</span>)</span>)&gt;<span class="var type1" id="S14T1U243">minVoltage</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">            <span class="mxinfo " id="T1:U188"><span class="var type1" id="S18T1U246">j</span>=<span class="mxinfo " id="T1:U190"><span class="var type1" id="S18T1U248">j</span>+<span class="mxinfo " id="T1:U192">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line">            <span class="mxinfo " id="T1:U193"><span class="mxinfo " id="T1:U194"><span class="var type1" id="S15T12U253">F</span>(<span class="var type1" id="S18T1U254">j</span>)</span>= (<span class="mxinfo " id="T1:U197"><span class="mxinfo " id="T1:U198">abs(<span class="mxinfo " id="T1:U199"><span class="mxinfo " id="T1:U200">abs(<span class="mxinfo " id="T1:U201"><span class="var type1" id="S17T4U263">U</span>(<span class="var type1" id="S21T1U264">k</span>,<span class="var type1" id="S23T1U265">i1</span>)</span>)</span>-<span class="mxinfo " id="T1:U205">abs(<span class="mxinfo " id="T1:U206"><span class="var type1" id="S8T1U269">C</span>*<span class="mxinfo " id="T1:U208">dot(<span class="mxinfo " id="T5:U209"><span class="fcn" id="F107N2:B273">Bfeld</span>(<span class="mxinfo " id="T5:U210"><span class="var type1" id="S13T6U275">m1</span>(<span class="var type1" id="S23T1U276">i1</span>,<span class="mxinfo " id="T7:U213">:</span>)</span>,<span class="mxinfo " id="T5:U214"><span class="mxinfo " id="T5:U215"><span class="mxinfo " id="T5:U216"><span class="var type1" id="S12T3U281">Koordinate_real_GLS</span>(<span class="var type1" id="S21T1U282">k</span>,<span class="mxinfo " id="T7:U219">1:3</span>)</span>-<span class="mxinfo " id="T5:U220"><span class="var type1" id="S10T6U287">r</span>(<span class="var type1" id="S23T1U288">i1</span>,<span class="mxinfo " id="T7:U223">:</span>)</span></span>+<span class="mxinfo " id="T5:U224"><span class="mxinfo " id="T5:U225"><span class="var type1" id="S3T2U292">x</span>(<span class="var type1" id="S23T1U293">i1</span>,<span class="mxinfo " id="T7:U228">4:6</span>)</span>/1000</span></span>)</span>,<span class="var type1" id="S22T5U298">n</span>)</span></span>)</span></span>)</span>/<span class="mxinfo " id="T1:U230">abs(<span class="mxinfo " id="T1:U231"><span class="var type1" id="S17T4U302">U</span>(<span class="var type1" id="S21T1U303">k</span>,<span class="var type1" id="S23T1U304">i1</span>)</span>)</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line">        <span class="keyword">end</span>     </span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T1:U235"><span class="var type1" id="S2T1U307">F_out</span>=<span class="mxinfo " id="T1:U237">mean(<span class="var type1" id="S15T12U310">F</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
